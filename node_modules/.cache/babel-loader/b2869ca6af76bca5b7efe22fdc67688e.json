{"ast":null,"code":"import _defineProperty from \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/src/components/NewsAdd/index.js\";\nimport React, { Component } from 'react';\nimport { apiUrl, apiRoutes } from '../../apiConfig';\n\nvar NewsAdd =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(NewsAdd, _Component);\n\n  function NewsAdd(props) {\n    var _this;\n\n    _classCallCheck(this, NewsAdd);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewsAdd).call(this, props));\n\n    _this.onChangeHandler = function (event) {\n      var _event$currentTarget = event.currentTarget,\n          name = _event$currentTarget.name,\n          value = _event$currentTarget.value;\n\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.onSubmitHandler = function (event) {\n      event.preventDefault();\n      var _this$state = _this.state,\n          title = _this$state.title,\n          author = _this$state.author,\n          text = _this$state.text;\n      var addNewsCallback = _this.props.addNewsCallback;\n\n      if ([title, author, text].some(function (el) {\n        return !el.length;\n      })) {\n        return _this.setState({\n          error: 'Заполните все поля!',\n          messages: ''\n        });\n      }\n\n      var requestUrl = apiUrl + apiRoutes.news + \"?title=\".concat(title, \"&author=\").concat(author, \"&text=\").concat(text);\n      fetch(requestUrl, {\n        method: 'POST'\n      }).then(function (res) {\n        var status = res.status;\n\n        if (status < 200 || status > 299) {\n          throw new Error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0434\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0438 \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438. \\u041A\\u043E\\u0434 \".concat(status));\n        }\n\n        return res.json();\n      }).then(function (addedNews) {\n        addNewsCallback(addedNews);\n\n        _this.setState({\n          title: '',\n          author: '',\n          text: '',\n          messages: 'Новость успешно добавлена!',\n          error: ''\n        });\n      }).catch(function (error) {\n        console.error(error);\n\n        _this.setState({\n          error: error.message,\n          messages: ''\n        });\n      });\n    };\n\n    _this.state = {\n      title: '',\n      author: '',\n      text: '',\n      messages: '',\n      error: ''\n    };\n    return _this;\n  }\n\n  _createClass(NewsAdd, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          title = _this$state2.title,\n          author = _this$state2.author,\n          text = _this$state2.text,\n          messages = _this$state2.messages,\n          error = _this$state2.error;\n      return React.createElement(\"form\", {\n        onSubmit: this.onSubmitHandler,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, !messages ? null : React.createElement(\"p\", {\n        className: \"App-messages-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, messages), !error ? null : React.createElement(\"p\", {\n        className: \"App-error-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430! \", error), React.createElement(\"label\", {\n        className: \"App-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A:\", React.createElement(\"input\", {\n        className: \"App-input-field\",\n        name: \"title\",\n        placeholder: \"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\",\n        onChange: this.onChangeHandler,\n        value: title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      })), React.createElement(\"label\", {\n        className: \"App-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, \"\\u0410\\u0432\\u0442\\u043E\\u0440:\", React.createElement(\"input\", {\n        className: \"App-input-field\",\n        name: \"author\",\n        placeholder: \"\\u0410\\u0432\\u0442\\u043E\\u0440\",\n        onChange: this.onChangeHandler,\n        value: author,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      })), React.createElement(\"label\", {\n        className: \"App-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"\\u0422\\u0435\\u043A\\u0441\\u0442:\", React.createElement(\"textarea\", {\n        className: \"App-input-field\",\n        name: \"text\",\n        placeholder: \"\\u0422\\u0435\\u043A\\u0441\\u0442\",\n        onChange: this.onChangeHandler,\n        value: text,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"));\n    }\n  }]);\n\n  return NewsAdd;\n}(Component);\n\nexport default NewsAdd;","map":{"version":3,"sources":["/home/valerii/react/WebDevSummit2018-SPA/conference.frontend/src/components/NewsAdd/index.js"],"names":["React","Component","apiUrl","apiRoutes","NewsAdd","props","onChangeHandler","event","currentTarget","name","value","setState","onSubmitHandler","preventDefault","state","title","author","text","addNewsCallback","some","el","length","error","messages","requestUrl","news","fetch","method","then","res","status","Error","json","addedNews","catch","console","message"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport { apiUrl, apiRoutes } from '../../apiConfig';\n\nclass NewsAdd extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            title: '',\n            author: '',\n            text: '',\n            messages: '',\n            error: '',\n        }\n    }\n\n    onChangeHandler = (event) => {\n        const { name, value } = event.currentTarget;\n        this.setState({[name]: value});\n    }\n\n    onSubmitHandler = (event) => {\n        event.preventDefault();\n\n        const { title, author, text } = this.state;\n        const { addNewsCallback } = this.props;\n\n        if ([title, author, text].some(el => !el.length)) {\n            return this.setState({error: 'Заполните все поля!', messages: ''});\n        }\n\n        const requestUrl = apiUrl + apiRoutes.news + `?title=${title}&author=${author}&text=${text}`;\n\n        fetch(requestUrl, {method: 'POST'})\n            .then(res => {\n                const { status } = res;\n\n                if (status < 200 || status > 299) {\n                    throw new Error(`Ошибка при добавлении новости. Код ${status}`);\n                }\n                \n                return res.json();\n            })\n            .then(addedNews => {\n                addNewsCallback(addedNews);\n                this.setState({\n                    title: '',\n                    author: '',\n                    text: '',\n                    messages: 'Новость успешно добавлена!',\n                    error: '',\n                });\n            })\n            .catch(error => {\n                console.error(error);\n                this.setState({error: error.message, messages: ''});\n            });\n    }\n\n    render() {\n        const { title, author, text, messages, error } = this.state;\n\n        return (\n            <form onSubmit={this.onSubmitHandler}>\n\n                {!messages ? null : (\n                    <p className=\"App-messages-box\">\n                        {messages}\n                    </p>\n                )}\n\n                {!error ? null : (\n                    <p className=\"App-error-box\">\n                        Ошибка! {error}\n                    </p>\n                )}\n                \n\n                <label className=\"App-label\">\n                    Заголовок:\n                    <input \n                        className=\"App-input-field\"\n                        name=\"title\" \n                        placeholder=\"Заголовок\" \n                        onChange={this.onChangeHandler}\n                        value={title}\n                    />\n                </label>\n                \n                <label className=\"App-label\">\n                    Автор:\n                    <input \n                    className=\"App-input-field\"\n                    name=\"author\"\n                    placeholder=\"Автор\"\n                    onChange={this.onChangeHandler}\n                    value={author}\n                    />\n                </label>\n                \n                <label className=\"App-label\">\n                    Текст:\n                    <textarea \n                        className=\"App-input-field\"\n                        name=\"text\"\n                        placeholder=\"Текст\"\n                        onChange={this.onChangeHandler}\n                        value={text}\n                    />\n                </label>\n                \n                <button type=\"submit\">\n                    Добавить\n                </button>\n            </form>\n        );\n    }\n}\n\nexport default NewsAdd;"]},"metadata":{},"sourceType":"module"}